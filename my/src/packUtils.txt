// src/services/pack-logic/packUtils.ts
import { generateUUID } from '../../utils/uuidUtils';  // ğŸ’¡ uuid/v4 ã®ä»£ã‚ã‚Šã«ã€æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‹ã‚‰é–¢æ•°ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import type { Pack } from "../../models/pack"; // ğŸ’¡ type ã‚’è¿½åŠ ã—ã¦TS1484ã‚’ä¿®æ­£

/**
 * ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒ‘ãƒƒã‚¯IDã‚’ç”Ÿæˆã™ã‚‹ã€‚
 * @returns {string} ç”Ÿæˆã•ã‚ŒãŸãƒ¦ãƒ‹ãƒ¼ã‚¯ãªãƒ‘ãƒƒã‚¯ID (UUID)
 */
export const generatePackId = (): string => {
    return generateUUID();
};


/**
 * ãƒ‘ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹å…¨ã¦ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚«ãƒ¼ãƒ‰ç·æ•°ï¼ˆPack.totalCardsï¼‰ã‚’è¨ˆç®—ã™ã‚‹ã€‚ï¼ˆç¾çŠ¶ã‚¹ã‚¿ãƒ–ï¼‰
 * ğŸ’¡ æ³¨æ„: ã“ã®å€¤ã¯ã€Packã«ç´ã¥ã‘ã‚‰ã‚ŒãŸå…¨ã‚«ãƒ¼ãƒ‰ï¼ˆPackCardPoolï¼‰ã®æ•°ã‚’é›†è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€
 * ç¾çŠ¶Packã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯ãã®ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ­ã‚¸ãƒƒã‚¯ã¯å®Ÿè£…ã›ãš0ã‚’è¿”ã—ã¾ã™ã€‚
 * @param {Pack} _pack - è¨ˆç®—å¯¾è±¡ã®ãƒ‘ãƒƒã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ (ğŸ’¡ _ ã‚’ä»˜ã‘ã¦æœªä½¿ç”¨ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™)
 * @returns {number} ç·åéŒ²ã‚«ãƒ¼ãƒ‰æ•°
 */
export const calculateTotalCards = (_pack: Pack): number => {
    // ãƒ•ã‚§ãƒ¼ã‚º1å¾ŒåŠã¾ãŸã¯ãƒ•ã‚§ãƒ¼ã‚º2ã§ã€DBã‹ã‚‰ç´ã¥ãã‚«ãƒ¼ãƒ‰ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
    return 0;
};

// ãƒ‘ãƒƒã‚¯ã®åˆæœŸå€¤ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°ï¼ˆæ–°è¦ä½œæˆæ™‚ç”¨ï¼‰
export const createDefaultPack = (): Pack => {
    const defaultPack: Pack = {
        packId: generatePackId(),
        name: 'æ–°è¦ãƒ‘ãƒƒã‚¯',
        series: 'æœªå®š',
        packType: 'Booster', // ğŸ’¡ PackType ã‚’è¿½åŠ 
        cardsPerPack: 12, // ğŸ’¡ 1ãƒ‘ãƒƒã‚¯ã‚ãŸã‚Šã®å°å…¥æšæ•° (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤)
        rarityConfig: [ // ğŸ’¡ rarityConfig ã‚’è¿½åŠ 
            { rarityName: 'Common', probability: 0.75 },
            { rarityName: 'Uncommon', probability: 0.20 },
            { rarityName: 'Rare', probability: 0.05 },
        ],
        totalCards: 0, // ç·åéŒ²ã‚«ãƒ¼ãƒ‰æ•°ã¯åˆæœŸå€¤0
        imageUrl: '',
        cardBackUrl: '',
        price: 300, 
        description: 'ãƒ–ãƒ¼ã‚¹ã‚¿ãƒ¼ãƒ‘ãƒƒã‚¯ã®èª¬æ˜ã‚’ã“ã“ã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', // ğŸ’¡ description ã‚’è¿½åŠ 
        releaseDate: new Date().toISOString().split('T')[0], 
        userCustom: {},
        isOpened: false, // ğŸ’¡ è¿½åŠ 
    };
    
    return defaultPack;
};
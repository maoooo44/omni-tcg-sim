// src/hooks/useCardData.ts

import { useEffect, useState } from 'react';
// ğŸ’¡ ãƒ‘ã‚¹ã‚’å†ä¿®æ­£: 'pack-logic' ã‚’æœ€çµ‚çš„ãªé…ç½®ã¨ã—ã¦ç¢ºå®š
import { cardDataService } from '../services/pack-logic/CardDataService'; 
import type { Card } from '../models/card';
// ğŸš¨ å‰Šé™¤ã•ã‚ŒãŸè¡Œ: import { useCardData } from './useCardData'; // å¾ªç’°å‚ç…§ã®æ ¹æœ¬åŸå› 

/**
 * ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†ãŸã‚ã®ãƒ•ãƒƒã‚¯
 */
export const useCardData = () => {
    // ãƒ‡ãƒ¼ã‚¿ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‹ã©ã†ã‹ã‚’è¿½è·¡
    const [isLoaded, setIsLoaded] = useState(false);
    
    useEffect(() => {
        // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆæ™‚ã«ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰
        cardDataService.loadAllCards()
            .then(success => {
                if (success) {
                    setIsLoaded(true);
                } else {
                    console.error('ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                }
            });
    }, []);

    /**
     * IDã‹ã‚‰ã‚«ãƒ¼ãƒ‰æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
     * @param cardId 
     * @returns 
     */
    const getCardInfo = (cardId: string): Card | undefined => {
        return cardDataService.getCardById(cardId);
    };

    /**
     * IDã‹ã‚‰ã‚«ãƒ¼ãƒ‰åã‚’å–å¾—ã™ã‚‹é–¢æ•°ï¼ˆUIã§ã®åˆ©ç”¨ã‚’æƒ³å®šï¼‰
     * @param cardId 
     * @returns 
     */
    const getCardName = (cardId: string): string => {
        // ğŸ’¡ ä¿®æ­£: getCardInfoã®çµæœã‚’åˆ©ç”¨ã—ã€ä¸æ˜ãªå ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        return getCardInfo(cardId)?.name ?? 'ä¸æ˜ãªã‚«ãƒ¼ãƒ‰';
    };

    /**
     * æ–°è¦è¿½åŠ : å…¨ã¦ã®ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
     * @returns å…¨ã¦ã®Cardã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é…åˆ—
     */
    const getAllCards = (): Card[] => {
        // cardDataServiceã«è¿½åŠ ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™
        return cardDataService.getAllCards();
    };


    return {
        isCardDataLoaded: isLoaded,
        getCardInfo,
        getCardName,
        getAllCards, // ğŸ’¡ ä¿®æ­£: getAllCardsã‚’ãƒ•ãƒƒã‚¯ã®æˆ»ã‚Šå€¤ã¨ã—ã¦å…¬é–‹
    };
};
// src/components/layout/MainLayout.tsx
import React from 'react';
import { Outlet } from '@tanstack/react-router';
import { Container } from '@mui/material';

// Navbarã¨ãã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import Navbar from '../Navbar'; 
// ğŸš¨ ä¿®æ­£1: coinsã‚’å–å¾—ã™ã‚‹ãŸã‚ã« useCurrencyStore ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import { useCurrencyStore } from '../../stores/currencyStore'; 
import { useUserDataStore } from '../../stores/userDataStore'; 
import { useShallow } from 'zustand/react/shallow'; 

const MainLayout: React.FC = () => {
    // âœ… Navbarã«å¿…è¦ãªPropsã‚’ã“ã“ã§å–å¾— (ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…ã§ã®ãƒ‡ãƒ¼ã‚¿å–å¾—)
    const navbarProps = useCurrencyStore(
        useShallow(state => ({
            coins: state.coins
        }))
    );

    // ğŸš¨ ä¿®æ­£2: userDataStore ã‹ã‚‰ DTCG/GodMode ã®è¨­å®šã‚’å–å¾—
    const userSettings = useUserDataStore(
        useShallow(state => ({
            isDTCGEnabled: state.isDTCGEnabled,
            isGodMode: state.isGodMode,
        }))
    );
    
    
    return (
        <>
            {/* âœ… Navbarã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ (MUIãƒ‡ã‚¶ã‚¤ãƒ³) */}
            <Navbar 
                isDTCGEnabled={userSettings.isDTCGEnabled} // ä¿®æ­£
                isGodMode={userSettings.isGodMode}       // ä¿®æ­£
                coins={navbarProps.coins}
            />
            
            {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é ˜åŸŸã®Containerã‚’ã“ã“ã§å®šç¾© (MUIãƒ‡ã‚¶ã‚¤ãƒ³) */}
            <Container maxWidth="lg" sx={{ pt: 3, pb: 6, minHeight: 'calc(100vh - 64px)' }}>
                {/* ãƒšãƒ¼ã‚¸ã®å†…å®¹ã¯ã“ã“ã«å…¥ã‚‹ */}
                <Outlet />
            </Container>
            
            {/* ä»¥å‰ã® MainLayout ã®ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆä»Šå›ã¯çœç•¥ï¼‰ */}
        </>
    );
};

export default MainLayout;